CREATE TABLE User
(
	user_ID 	BIGINT UNSIGNED 		NOT NULL AUTO_INCREMENT,
	username 	VARCHAR(255)			UNIQUE,
	email		VARCHAR(255),
	user_since	DATETIME				DEFAULT NOW(),
	deleted		BOOLEAN					DEFAULT FALSE,

	PRIMARY KEY (user_ID)
);

CREATE TABLE Media
(
	media_ID			BIGINT UNSIGNED 	NOT NULL AUTO_INCREMENT,
	filename			VARCHAR(18)			UNIQUE,
	description			VARCHAR(1024),
	source				VARCHAR(255),
	upload_date 		DATETIME			DEFAULT NOW(),
	uploader 			BIGINT UNSIGNED,
	link_forward_ID		BIGINT UNSIGNED,
	link_previous_ID	BIGINT UNSIGNED,

	PRIMARY KEY (media_ID),
	FOREIGN KEY (uploader) REFERENCES User(user_ID),
	FOREIGN KEY (link_forward_ID) REFERENCES Media(media_ID) ON DELETE SET NULL,
	FOREIGN KEY (link_previous_ID) REFERENCES Media(media_ID) ON DELETE SET NULL

);

CREATE TABLE UserProfileMedia
(
	profile_pic_ID	BIGINT UNSIGNED 	DEFAULT 0,
	user_ID 		BIGINT UNSIGNED,

	PRIMARY	KEY (profile_pic_ID, user_ID),
	FOREIGN KEY (profile_pic_ID) REFERENCES Media(media_ID),
	FOREIGN KEY (user_ID) REFERENCES User(user_ID)
);

CREATE TABLE Tag
(
	tag_ID		BIGINT UNSIGNED 		NOT NULL AUTO_INCREMENT,
	description	VARCHAR(255),

	PRIMARY KEY (tag_ID)
);

CREATE TABLE MediaTag
(
	tag_ID			BIGINT UNSIGNED			NOT NULL,
	media_ID		BIGINT UNSIGNED 		NOT NULL,
	placing			INT UNSIGNED			NOT NULL,
	responsible_user_ID 	BIGINT UNSIGNED,

	PRIMARY KEY (tag_ID, media_ID),
	FOREIGN KEY (tag_ID) REFERENCES Tag(tag_ID),
	FOREIGN KEY (media_ID) REFERENCES Media(media_ID) 	ON DELETE CASCADE,
	FOREIGN KEY (responsible_user_ID) REFERENCES User(user_ID)
);

CREATE TABLE UserFeedback
(
	user_ID 	BIGINT UNSIGNED		NOT NULL,
	media_ID	BIGINT UNSIGNED		NOT NULL,
	upvote		BOOLEAN				DEFAULT FALSE,
	downvote 	BOOLEAN				DEFAULT FALSE,
	favorite	BOOLEAN				DEFAULT FALSE,

	PRIMARY KEY (user_ID, media_ID),
	FOREIGN KEY (user_ID) REFERENCES User(user_ID),
	FOREIGN KEY (media_ID) REFERENCES Media(media_ID) ON DELETE CASCADE
);


CREATE TABLE Comment
(
	comment_ID	BIGINT UNSIGNED		NOT NULL AUTO_INCREMENT,
	user_ID 	BIGINT UNSIGNED,
	media_ID	BIGINT UNSIGNED,
	comment 	VARCHAR(1024),

	PRIMARY KEY (comment_ID),
	FOREIGN KEY (user_ID) REFERENCES User(user_ID)
);